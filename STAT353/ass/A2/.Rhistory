lower
logR(theta,thetahat,yi,ti)-log(p)
p<-.1
logR.m.lnp<-function(theta,thetahat,p,yi,ti){
logR(theta,thetahat,yi,ti)-log(p)
}
lower<-uniroot(logR.m.lnp,c(5,10),thetahat$maximum,p,yi,ti)
lower
upper<-uniroot(logR.m.lnp,c(25,40),thetahat$maximum,p,yi,ti)
upper
set.seed(12345)
y<-rweibull(10,shape=2,scale=1)
y
```
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
theta<-seq(0,5,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta')
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
abline(h=log(.1))
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
#10% CI
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,5,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
#10% CI
p<-.1
logR.m.lnp<-function(theta,thetahat,x,p){
logR(theta,thetahat,x)-log(p)
theta<-seq(0,3,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,3,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,3,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
#10% CI
p<-.1
logR.m.lnp<-function(theta,thetahat,x,p){
logR(theta,thetahat,x)-log(p)
}
lower<-uniroot(logR.m.lnp,c())
```
#log likelihood function
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,3,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
theta<-seq(0,10,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
#10% CI
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(.1))
#10% CI
abline(h=log(.1))
yi<-c(4.42,4.75,6.63,.14,3.16,.15,38.34,7.07,5.09,9.09)
ti<-c(1,1.11,1.22,1.33,1.44,1.56,1.67,1.78,1.89,2)
#log likelihood function
ell<-function(theta,yi,ti){
-length(yi)*log(theta)-sum(yi*ti)/theta
}
theta<-seq(3,30,by=.01)
#plot
plot(theta,ell(theta,yi,ti),main='practice',ylab='log likelihood',xlab='theta')
#MLE
thetahat<-optimize(ell,c(5,15),maximum=TRUE,yi,ti)
thetahat
#log relative likelihood function
logR<-function(theta,thetahat,yi,ti){
ell(theta,yi,ti)-ell(thetahat,yi,ti)
}
#plot
plot(theta,logR(theta,thetahat$maximum,yi,ti),main='practice',ylab='log likelihood',xlab='theta',type='l')
abline(h=log(.1))
abline(h=log(.1))
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
#log likelihood function
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,10,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
yi<-c(4.42,4.75,6.63,.14,3.16,.15,38.34,7.07,5.09,9.09)
ti<-c(1,1.11,1.22,1.33,1.44,1.56,1.67,1.78,1.89,2)
#log likelihood function
ell<-function(theta,yi,ti){
-length(yi)*log(theta)-sum(yi*ti)/theta
}
theta<-seq(3,30,by=.01)
#plot
plot(theta,ell(theta,yi,ti),main='practice',ylab='log likelihood',xlab='theta')
#MLE
thetahat<-optimize(ell,c(5,15),maximum=TRUE,yi,ti)
thetahat
#log relative likelihood function
logR<-function(theta,thetahat,yi,ti){
ell(theta,yi,ti)-ell(thetahat,yi,ti)
}
#plot
plot(theta,logR(theta,thetahat$maximum,yi,ti),main='practice',ylab='log likelihood',xlab='theta',type='l')
abline(h=log(.1))
#10% likelihood intervals
p<-.1
logR.m.lnp<-function(theta,thetahat,p,yi,ti){
logR(theta,thetahat,yi,ti)-log(p)
}
lower<-uniroot(logR.m.lnp,c(5,10),thetahat$maximum,p,yi,ti)
lower
upper<-uniroot(logR.m.lnp,c(25,40),thetahat$maximum,p,yi,ti)
upper
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
set.seed(12345)
y<-rweibull(10,shape=2,scale=1)
y
```
set.seed(12345)
y<-rweibull(10,shape=2,scale=1)
y
```
```{r}
#log likelihood function
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
#plot
theta<-seq(0,10,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(.1))
#10% CI
abline(h=log(.1))
abline(h=log(.1))
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(.1))
abline(h=log(0.1))
theta<-seq(.5,3,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(0,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(0.1))
theta<-seq(0,10,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
#MLE
thethat<-optimize(ell,c(.5,3),maximum=TRUE,x)
thethat
#log relative lieklihood
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(0.1))
abline(h=log(0.1))
#10% CI
p<-.1
logR.m.lnp<-function(theta,thetahat,x,p){
logR(theta,thetahat,x)-log(p)
}
lower<-uniroot(logR.m.lnp,c())
```
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta')
abline(h=log(.5))
p<-.1
logR.m.lnp<-function(theta,thetahat,x,p){
logR(theta,thetahat,x)-log(p)
}
lower<-uniroot(logR.m.lnp,c(0.1.8),thetahat$maximum,p,x)
lower
lower<-uniroot(logR.m.lnp,c(0,1.8),thetahat$maximum,p,x)
p<-.1
logR.m.lnp<-function(theta,thetahat,x,p){
logR(theta,thetahat,x)-log(p)
}
lower<-uniroot(logR.m.lnp,c(0,1.8),thetahat$maximum,p,x)
lower
abline(h=log(.1))
set.seed(12345)
y<-rweibull(10,shape=2,scale=1)
y
x<-c(.57,.36,.52,.35,.89,1.34,1.06,.82,.56,.10)
ell<-function(theta,x){
n<-length(x)
res.ell<-vector('numeric',length(theta))
for(i in 1:length(theta)){
res.ell[i]<-n*log(theta[i])+(theta[i]-1)*sum(log(x))-sum(x^theta[i])
}
return(res.ell)
}
ell(2,x)
theta<-seq(0,10,by=.01)
plot(theta,ell(theta,x),main='practice',ylab='log likelihood',xlab='theta',type='l')
thetahat<-optimize(ell,c(0,4),maximum=TRUE,x)
thetahat
logR<-function(theta,thetahat,x){
ell(theta,x)-ell(thetahat,x)
}
#plot
plot(theta,logR(theta,thetahat$maximum,x),main='practice',ylab='log relative likelihood',xlab='theta',type='l')
abline(h=log(.1))
p<-.1
logR.m.lnp<-function(theta,thetahat,p,x){
logR(theta,thetahat,x)-log(p)
}
lower<-uniroot(logR.m.lnp,c(0,2),thetahat$maximum,p,x)
lower
upper<-uniroot(logR.m.lnp,c(2,4),thetahat$maximum,p,x)
upper
z<-c(1,3,-4,0,6)
y<-z[(z+z)<6]
y
(z+z)<6
1+sum((z+z)<6)
set.seed(6789)
qnorm(.975)
c1<-0
for(i in 1:1000){
x<-rnorm(100)
CI<-mean(x)+c(-1,1)*1.96/sqrt(100)
if((CI[1]<=0)&(CI[2]>=0)) c1<-c1+1
}
c1
w<-read.csv('SalaryWT3n4')
w34<-read.csv('SalaryWT3n4')
w34<-read.csv('SalaryWT3n4')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w<-read.csv('SalaryWT3n4.csv')
w<-read.csv('SalaryWT3n4.csv')
```
# read the data set from the csv file
w<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('Salarywt3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('SalaryWT3n4.csv')
```
You can also embed plots, for example:
```{r, echo=FALSE}
plot(cars)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
w34<-read.csv('SalaryWT3n4.csv')
w34<-read.csv('f.csv')
getwd()
setwd("/Users/lizhaocheng/Desktop/Zhaocheng-s/S")
setwd("/Users/lizhaocheng/Desktop/Zhaocheng-s/STAT353/ass/A2/")
data1=read.table(file="data-table-B4.prn",header=TRUE)
data2=read.table(file="data-table-B7.prn",header=TRUE)
attach(data1)
attach(data2)
print(data1)
print(data2)
fit1=lm(y~x1+x2+x3+x4+x5+x6+x7+x8+x9,data1)
fit2=lm(y~x1+x2+x3+x4+x5,data2)
data3=read.table(file="data-ex-3-1.prn",header="TRUE")
data3=read.table(file="data-ex-3-1.prn",header=TRUE)
attach(data3)
summary(data3)
fit3=lm(y~x1+x2,data3)
summary(fit3)
anova(fit3)
fit4=lm(y~x2,data3)
anova(fit4)
anova(fit1)
fit5=lm(y~x2+x3+x4+x5+x6+x7+x8+x9,data1)
anova(fit5)
fit6=lm(y~x1+x3+x4+x5+x6+x7+x8+x9,data1)
anova(fit6)
fit7=lm(y~x1+x2+x4+x5+x6+x7+x8+x9,data1)
anova(fit7)
fit8=lm(y~x1+x2+x3+x5+x6+x7+x8+x9,data1)
anova(fit8)
fit9=lm(y~x1+x2+x3+x4+x6+x7+x8+x9,data1)
anova(fit9)
fit10=lm(y~x1+x2+x3+x4+x5+x7+x8+x9,data1)
anova(fit10)
fit11=lm(y~x1+x2+x3+x4+x5+x6+x8+x9,data1)
anova(fit11)
fit12=lm(y~x1+x2+x3+x4+x5+x6+x7+x9,data1)
anova(fit12)
fit13=lm(y~x1+x2+x3+x4+x5+x6+x7+x8,data1)
anova(fit13)
pv = 1-pf(3.5026,1,14)
pv
pv = 1-pf(2.6620,1,14)
pv
pv = 1-pf(0.1023,1,14)
pv
pv = 1-pf(0.4013,1,14)
pv
pv = 1-pf(2.5942,1,14)
pv
pv = 1-pf(0.0391,1,14)
pv
pv = 1-pf(0.1805,1,14)
pv
pv = 1-pf(0.3208,1,14)
pv
fit14=lm(y~x1+x2+x5+x6+x7+x8,data1)
anove(fit14)
anova(fit14)
fit15=lm(y~x1+x2+x3+x5+x6+x7+x8,data1)
anova(fit15)
summary(fit2)
anova(fit2)
fit16=lm(y~x2+x3+x4+x5,data2)
anova(fit16)
fit17=lm(y~x1+x3+x4+x5,data2)
anova(fit17)
fit18=lm(y~x1+x2+x4+x5,data2)
anova(fit18)
fit19=lm(y~x1+x2+x3+x5,data2)
anova(fit19)
fit20=lm(y~x1+x2+x3+x4,data2)
anova(fit20)
pv =1-pf(3.4588,1,10)
pv
pv =1-pf(23.9831,1,10)
pv
pv =1-pf(0.2337,1,10)
pv
pv =1-pf(0.1384,1,10)
pv
pv =1-pf(121.9062,1,10)
pv
summary(fit2)
fit21=lm(y~x2+x5,data2)
summary(fit21)
summary(fit2)
summary.lm(fit2)
summary.lm(fit21)
lower1=1.6159-qt(0.975,22)*5.761e-02
upper1=1.6159+qt(0.975,22)*5.761e-02
cat("The 95% CI for beta1 is: ("lower1","upper1")")
cat("The 95% CI for beta1 is: ("lower1"",""upper1")")
cat("The 95% CI for beta1 is")
cat("The 95% CI for beta1 is (lower1)")
cat("The 95% CI for beta1 is ('lower1')")
cat("The 95% CI for beta1 is ",lower1)
cat("The 95% CI for beta1 is ","lower1")
cat("The 95% CI for beta1 is ",(lower1,upper1))
cat("The 95% CI for beta1 is ","(",lower1,",","upper1"))
cat("The 95% CI for beta1 is ","(",lower1,",","upper1",")")
cat("The 95% CI for beta1 is:"(",lower1,",","upper1",")")
cat("The 95% CI for beta1 is:,"(",lower1,",","upper1",")")
cat("The 95% CI for beta1 is:,"(",lower1,",",upper1,")")
c
cat("The 95% CI for beta1 is:)
cat("The 95% CI for beta1 is:")
cat("The 95% CI for beta1 is:","(")
cat("The 95% CI for beta1 is:","(",lower1)
cat("The 95% CI for beta1 is:","(",lower1,upper1)
cat("The 95% CI for beta1 is:","(",lower1,upper1,")")
cat("The 95% CI for beta2 in fit2 is:","(",lower1,upper1,")")
summary.lm(fit3)
summay.lm(fit2)
summary.lm(fit2)
lower1=(2.821e-01)-qt(0.975,22)*5.761e-02
upper1=(2.821e-01)+qt(0.975,22)*5.761e-02
cat("The 95% CI for beta2 in fit2 is:","(",lower1,upper1,")")
summary.lm(fit21)
lower2=(0.28214)-qt(0.975,22)*0.05883
upper1=(0.28214)+qt(0.975,22)*0.05883
cat("The 95% CI for beta2 in fit21 is:","(",lower2,upper2,")")
upper2=(0.28214)+qt(0.975,22)*0.05883
cat("The 95% CI for beta2 in fit21 is:","(",lower2,upper2,")")
