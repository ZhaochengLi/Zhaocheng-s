<pre><div class="text_to_html"># Example 2.8: Regression through origin (shelf-stocking data)

# This example illustrates the following
#
# 1. the &quot;lsfit&quot; command
# 2. the &quot;lmrob&quot; command (for contaminated data)
# 3. how to fit a linear model through origin with &quot;lsfit&quot; and &quot;lm&quot;
# 4. how to retrieve residuals from a fit
# 5. how to compute the fitted value using the residuals
# 6. how to plot the residuals and generate a multi-plot graph
# 7. how to plot confidence band for the regression line
#
# Warning: this R script contains many redundant commands/fits. This is 
#          for learning and contrasting these commands, and you should 
#          not write your R code for homework this way; you include only
#          those commands/fits which are necessary.


### [1] Reading data into R and checking data
#
#   see the previous R script for file handling information.

data2=read.table(file=&quot;data-ex-2-8 (Shelf-Stocking).prn&quot;, header=TRUE)  
attach(data2)  # data2 is a table in R. This allows variables in the table to be used individually.
print(data2)   # see if there data points are correct


### [2] Data analysis (with different models and R commands)

par(mfrow=c(2,2))    # create 2x2 frame to hold 4 plots
plot(t,y)
title(&quot;Shelf-stock data analysis&quot;)


fit1=lsfit(t,y)      # least-squares regression with intercept
ls.print(fit1)
abline(fit1,col=&quot;red&quot;) # add the ls line to the scatter plot

fit2=lsfit(t,y,intercept=FALSE)  # least-squares regression without intercept
ls.print(fit2)
abline(fit2,col=&quot;blue&quot;) # add the ls line to the scatter plot

fit3=lm(y~t,data2)   # fit a linear model with intercept; same as lsfit
anova(fit3)   # view ANOVA part of the results
summary(fit3) # see other results (t-tests, F-tests, R-squared) 

# plot confidence bands for the regression line; &quot;predict&quot; command works 
# with fit generated by &quot;lm&quot; command

newx=data.frame(x=t)   # specify x values at which predictions about y are to be made
band=predict(fit3, newx, interval=&quot;confidence&quot;)   # predictions for the E(y|x) at x=5 and x=10
lines(t,band[,2],lty=2, col=&quot;red&quot;)
lines(t,band[,3],lty=2, col=&quot;red&quot;)


fit4=lm(y~0+t,data2)   # fit a linear model without intercept
anova(fit4)   # view ANOVA part of the results
summary(fit4) # see other results (t-tests, F-tests, R-squared) 
abline(fit4,col=&quot;black&quot;) # add the ls line to the scatter plot


# Robust estimation of linear models for contaminated data. Must install
# and load up the robust package first.
#
fit5=lmrob(y~t)  # robust estimation of linear model
summary(fit5)
abline(fit5,col=&quot;green&quot;) # add the ls line to the scatter plot

### [3] Residual plots

r1=fit1$residuals  # retrieve residuals from fit1
r2=fit2$residuals
r5=fit3$residuals

fitted1=y-r1       # fitted y-value is observed y minus residual
fitted2=y-r2
fitted5=y-r5

plot(fitted1,r1)
abline(h=0)        # a horizontal line at y=0.
title(&quot;With intercept model residuals&quot;)


plot(fitted2,r2)
abline(h=0)
title(&quot;Without intercept model residuals&quot;)


plot(fitted5,r5)
abline(h=0)
title(&quot;Robust fit residuals&quot;)


</div></pre>